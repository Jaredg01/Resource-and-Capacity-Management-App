{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/SAIT/capstone_project/Resource-and-Capacity-Management-App/resource-and-capacity-management-app/app/api/Resource-Manager/Employees/route.js"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport clientPromise from '../../../../lib/mongodb';\r\n\r\nexport async function GET() {\r\n  try {\r\n    const client = await clientPromise;\r\n    const db = client.db(\"YourDatabaseName\");\r\n\r\n    const employees = await db.collection(\"employee\").aggregate([\r\n      {\r\n        // 1. Join with Department collection\r\n        $lookup: {\r\n          from: \"department\",\r\n          localField: \"dept_no\",\r\n          foreignField: \"dept_no\",\r\n          as: \"dept_info\"\r\n        }\r\n      },\r\n      {\r\n        // 2. Join with Capacity collection\r\n        $lookup: {\r\n          from: \"capacity\",\r\n          localField: \"emp_id\",\r\n          foreignField: \"emp_id\",\r\n          as: \"capacity_info\"\r\n        }\r\n      },\r\n      {\r\n        // 3. Clean up the output\r\n        $project: {\r\n          emp_id: 1,\r\n          emp_name: 1,\r\n          emp_title: 1,\r\n          dept_no: 1,\r\n          manager_id: 1,\r\n          dept_name: { $arrayElemAt: [\"$dept_info.dept_name\", 0] },\r\n          capacity: \"$capacity_info\"\r\n        }\r\n      }\r\n    ]).toArray();\r\n\r\n    return NextResponse.json(employees);\r\n  } catch (e) {\r\n    console.error(e);\r\n    return NextResponse.json({ error: \"Failed to fetch data\" }, { status: 500 });\r\n  }\r\n}"],"names":[],"mappings":";;;;AAAA;;;;;;;;AAGO,eAAe;IACpB,IAAI;QACF,MAAM,SAAS,MAAM;QACrB,MAAM,KAAK,OAAO,EAAE,CAAC;QAErB,MAAM,YAAY,MAAM,GAAG,UAAU,CAAC,YAAY,SAAS,CAAC;YAC1D;gBACE,qCAAqC;gBACrC,SAAS;oBACP,MAAM;oBACN,YAAY;oBACZ,cAAc;oBACd,IAAI;gBACN;YACF;YACA;gBACE,mCAAmC;gBACnC,SAAS;oBACP,MAAM;oBACN,YAAY;oBACZ,cAAc;oBACd,IAAI;gBACN;YACF;YACA;gBACE,yBAAyB;gBACzB,UAAU;oBACR,QAAQ;oBACR,UAAU;oBACV,WAAW;oBACX,SAAS;oBACT,YAAY;oBACZ,WAAW;wBAAE,cAAc;4BAAC;4BAAwB;yBAAE;oBAAC;oBACvD,UAAU;gBACZ;YACF;SACD,EAAE,OAAO;QAEV,OAAO,oMAAY,CAAC,IAAI,CAAC;IAC3B,EAAE,OAAO,GAAG;QACV,QAAQ,KAAK,CAAC;QACd,OAAO,oMAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAuB,GAAG;YAAE,QAAQ;QAAI;IAC5E;AACF"}}]
}